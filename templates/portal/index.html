{% extends 'base.html' %}
{% block title %}Ù¾Û†Ø±ØªØ§ÚµÛŒ ÛŒØ§Ø±ÛŒ{% endblock %}
{% block content %}
<h2>Ù¾Û†Ø±ØªØ§ÚµÛŒ ÛŒØ§Ø±ÛŒ</h2>

<form method='post' class='card' style='display:flex;gap:10px;align-items:center'>
  <span class='muted'>Ù†Ø§ÙˆÛŒ Ø¨Û•Ú©Ø§Ø±Ù‡ÛŽÙ†Û•Ø±:</span>
  <input name='username' placeholder='Ù†Ø§ÙˆØª Ø¨Ù†ÙˆÙˆØ³Û•' value='{{ session.username or "" }}' style='width:220px'>
  <button class='btn small'>Ù‡Û•ÚµØ¨Ú˜Ø§Ø±Ø¯Ù†</button>
</form>

<h3 style='margin-top:16px'>Ù„ÛŒØ³ØªÛŒ ÛŒØ§Ø±ÛŒÛŒÛ•Ú©Ø§Ù†</h3>
<div class='grid'>
  {% for g in games %}
  <div class='card'>
    <div style='display:flex;justify-content:space-between;align-items:center'>
      <div style='font-weight:700'>{{ g.title }}</div>
      <span class='pill'>ðŸª™ {{ game_points_label(g.id) }}</span>
    </div>

    <!-- Ù†Ø§ÙˆÙ†Ø§Ù†ÛŒ Ú˜ÙˆÙˆØ± + Ù¾ÛŒÙˆÛ•Ø³ØªÙ† -->
    <div class='row' style='gap:.5rem;flex-wrap:wrap;margin:.5rem 0'>
      <input id='room-{{ g.id }}' placeholder='Ú©Û†Ø¯ÛŒ Ú˜ÙˆÙˆØ±/Ù†Ø§Ùˆ' value='public' style='width:180px'>
      <button class='btn' type='button' onclick='joinRoom({{ g.id }})'>Ø¯Û•Ø³ØªÙ¾ÛŽÚ©Ø±Ø¯Ù†</button>
      <input id='roomname-{{ g.id }}' placeholder='Ù†Ø§ÙˆÛŒ Ú˜ÙˆÙˆØ± (Ø¦Ø§Ø±Û•Ø²ÙˆÙˆÙ…Û•Ù†Ø¯Ø§Ù†Û•)' style='width:180px'>
      <button class='btn secondary' type='button' onclick='createRoom({{ g.id }})'>+ Ø¯Ø±ÙˆØ³ØªÚ©Ø±Ø¯Ù†ÛŒ Ú˜ÙˆÙˆØ±</button>
    </div>

    <!-- Ú˜ÙˆÙˆØ±Û• Ú©Û†ØªØ§Ù‡Û•Ú©Ø§Ù† -->
    <div>
      <div class='muted' style='margin-bottom:.3rem'>Ú˜ÙˆÙˆØ±Û• Ú©Û†ØªØ§Ù‡Û•Ú©Ø§Ù†</div>
      <div id='rooms-{{ g.id }}' style='display:flex;gap:.4rem;flex-wrap:wrap'></div>
      <button class='btn small' type='button' onclick='listRooms({{ g.id }})'>â†» Ù†ÙˆÛŽÚ©Ø±Ø¯Ù†Û•ÙˆÛ•ÛŒ Ú˜ÙˆÙˆØ±Û•Ú©Ø§Ù†</button>
    </div>
  </div>
  {% else %}<div class='muted'>Ù‡ÛŒÚ† ÛŒØ§Ø±ÛŒÛŒÛ•Ú© Ù†ÛŒÛŒÛ•.</div>{% endfor %}
</div>

<script src='/static/portal.js'></script>
<script>
  // Ø¯ÙˆØ§ØªØ± Ù„Û• Ù„Û†Ø¯Ø¯Ø§ØŒ Ø¨Û† Ù‡Û•Ø± ÛŒØ§Ø±ÛŒÛŒÛ•Ú© Ú˜ÙˆÙˆØ±Û•Ú©Ø§Ù† Ø¨Ø®ÙˆÛŽÙ†Û•ÙˆÛ•
  (function(){ {% for g in games %} try{ listRooms({{ g.id }}); }catch(e){} {% endfor %} })();
</script>
{% endblock %}
