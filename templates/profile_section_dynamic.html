{% extends "base.html" %}
{% block title %}{{ package.title }}{% endblock %}
{% block content %}
<h2>{{ package.title }}</h2>
<form method="post" class="card" style="max-width:860px">
  <div class="grid">
    {% for q in questions %}
      <div class="row">
        <label>{{ q.q_text }} {% if q.required %}<span class="muted">(*)</span>{% endif %}</label>

        {% set name = 'q_' ~ q.id %}
        {% set val = (answers[name] if answers else '') %}

        {% if q.q_type=='text' %}
          <input name="{{name}}" value="{{val}}">
        {% elif q.q_type=='textarea' %}
          <textarea name="{{name}}">{{val}}</textarea>
        {% elif q.q_type=='number' %}
          <input type="number" name="{{name}}" value="{{val}}">
        {% elif q.q_type=='date' %}
          <input type="date" name="{{name}}" value="{{val}}">
        {% elif q.q_type=='select' %}
          <select name="{{name}}">
            {% for op in q.options or [] %}
              <option value="{{op}}" {{ 'selected' if val==op }}>{{ op }}</option>
            {% endfor %}
          </select>
        {% elif q.q_type=='radio' %}
          {% for op in q.options or [] %}
            <label style="display:block"><input type="radio" name="{{name}}" value="{{op}}" {{ 'checked' if val==op }}> {{ op }}</label>
          {% endfor %}
        {% elif q.q_type=='checkbox' %}
          {% set picked = (val.split(', ') if val else []) %}
          {% for op in q.options or [] %}
            <label style="display:block"><input type="checkbox" name="{{name}}" value="{{op}}" {{ 'checked' if op in picked }}> {{ op }}</label>
          {% endfor %}
        {% elif q.q_type=='yesno' %}
          <select name="{{name}}">
            <option value="نەخێر" {{ 'selected' if val=='نەخێر' }}>نەخێر</option>
            <option value="بەڵێ"  {{ 'selected' if val=='بەڵێ'  }}>بەڵێ</option>
          </select>
        {% elif q.q_type=='rating5' %}
          <div>
            {% for i in range(1,6) %}
              <label style="margin-inline:6px"><input type="radio" name="{{name}}" value="{{i}}" {{ 'checked' if val|string==i|string }}> {{ i }}</label>
            {% endfor %}
          </div>
        {% elif q.q_type=='scale10' %}
          <input type="range" min="1" max="10" name="{{name}}" value="{{ val or 5 }}" oninput="this.nextElementSibling.innerText=this.value">
          <span class="muted">{{ val or 5 }}</span>
        {% else %}
          <input name="{{name}}" value="{{val}}">
        {% endif %}
      </div>
    {% endfor %}
  </div>

  <div style="margin-top:10px">
    <button class="btn" type="submit">پاشەکەوت</button>
    <!-- back link fixed to profile (no profile_setup) -->
    <a class="btn secondary" href="{{ url_for('profile') }}">گەرانەوە</a>
  </div>
</form>
{% endblock %}
